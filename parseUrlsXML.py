
#~. ~..:~.:~ .~. ~~.~~..~ .~:.~~.~~..~..~~.~:. ~ .:~.~:. ~..~ .:~ ~~. ~..~:.~~ .~~ ~~ ~
# ~~.:~  ~..~~.~~..~..~:.~~..~. ~..~~.:~..~  ~:.~~ ,~..~:.~~.:~..~. ~~.~~. ~..~~.~ ~~ ~
#.~~.:~  ~..:~.~~..~ .~:.~~..~. ~..~~.:~..~. ~~.:~ ,~..~,.~~.,=N?~..$8NMO..~..:~.~ ~~ ~
#: .~. ~~ ~~. ~  ~= ~~  ~. ~~ ~~ ~~  ~. ~~ ~~  ~. :~.~~  ~. ?+?D:.MMMMMMM:~ ~~. ~~ ~~ ~
#.~~ ~~  ~  ~~ ~~  ~. ~~ ~~  ~  ~  ~~ ~~ .~. ~~ ~~ .++?7I+IIIZN..MMMMMMMM .~  ~~ ~ ~~ ~
#~ .~  ~~ ~~  ~  ~~ ~~  ~  ~~ ~~ ~~. ~. ~~ ~~ .~+$??$+=?=I?+N. ~MMMMMMMM$~~ ~~  ~~ ~~ ~
# ~~ ~~  ~  ~~ ~~ .~  ~~ ~~ .~  ~  ~~ ~~ .~  ~=?I7~+?~==?=+Z$~~MMMMMMMMM+  ~  ~~ ~ ~~ ~
#~. ~ .~~.~~..~. ~~.~~..~ .~~.~:.~~ .~ .~~.~~~~~=~+=~=+==~=7M$MMMMMMMMM8.~~.~~..~~ ~~ ~
#.~~ ~~. ~  ~~ ~~  ~. ~~ ~~  ~  ~  ~~ ~=ZO$7I+=~====~=~=?=+MMMDMMMMMMMD~~ .~  ~~ ~ ~~ ~
#~ .~  ~~ ~~  ~  ~~ ~~  ~  ~~ ~~ ~~  ~..~~.~8+~~=~~++~==+=?NMMMMMMMN: ~. ~~ ~~?II~ ~~ ~
#.~~ ~~  ~  ~~ ~~  ~. ~~ ~~ .~  ~~IMNMMM. ~ 8=~~+~+??+~?==~MMZMMMDOI+7MMDNMMMMMM7MMMMMM
#~ .~  ~~ ~~  ~ .~~ ~~  ~  ~~ ~ZMMMMMMMMMMMMM=7~~~=+~?7+?~~MMMMNMMMMMMMMMMMMMMMMMMMMMMM
#.~~ ~~  ~  ~~ ~~  ~. ~~ ~~  ~.ZMMMMMMMMMMMMMNDDND=~====I?I+MMMMMMMMMMMMMMMMMMMMMMMMMMM
#~  ~  ~~ ~~. ~ .~~ ~~  ~  ~~ ~~IMMMMMMMMMMMMDMNMDD~+=~~=7++=MMMMNMMMMMMMMMMMMMMMMMMMMM
# ~~ ~~  ~  ~~ ~~  ~  ~~ ~~ .~  ~.,MMMMMMMMMMMN88MM~~~:~~=++++MONNNMMMMMMMMMMMMMMMMMMMM
#~ .~  ~~ ~~  ~  ~~ ~~  ~  ~: ~~ :~ .+7N$:$~~  DDND8~~:~::~~++++++MMMMMMMMMMMMMMMMMMMMM
#.~~ ~~  ~  ~~ ~~  ~. ~~ ~~  ~  ~  ~~ ~~..~  ~~MNNND~:::~~~~~I+????MMMMMMMMMMMMMMMMMMMM
#~  ~  ~~ :~. ~  ~~ :~ .~. ~~ ~: ~~. ~. ~: ~~ .:8NZ=~:~+OZ88ONM8+?77MMMMMMMMMMMMMMMMMMM
# ~~ :~. ~. ~~ ~:  ~  ~: ~~ .~  ~. :~ :~  ~ .~~ ==~=:+$$$$Z7NMN8?+77MMMMMMMMMMMMMMMMMMM
#~  ~. ~~ ,~  ~  ~: ~~ .~. ~: ~: :~  ~. ~~ :~  ~. =~~$MN8DD8N8N88DZ$MMMMMMMMMMMMMMMMMMM
#~  ~. ~~ :~  ~ .~: ~~ .~. ~: ~: :~. ~. ~: :~ .~. ~===8O7DDNDMNMMZ$$MMMMMMMMMMMMMMMMMMM
#.~~ ~~  ~  ~~ ~~  ~. ~~ ~~  ~  ~  ~~ ~~ .~. ~~ ~~.==~++NNNMMMN8OZ$$MMMMMMMMMMMMMMMMMMM
#~ .~  ~~ ~~  ~  ~~ ~~  ~  ~~ ~~ ~~. ~  ~~ ~~  ~  ~~,IODMMNN88DZ$$Z$MMMMMMMMMMMMMMMMMMM
# ~~.~~..~..~~.~:. ~ .~:.:~..~. ~ .~~.~~. ~..~~.~~..:.D777$O8DO77Z$ZMMMMMMMMMMMMMMMMMMM
#~. ~..::.~~..~. ~~.:~. ~..~~.~~.~~..~..~:.~~..~..~~.~~ N+==78Z78MO$MMMMMMMMMMMMMMMMMMM
# ~: :~  ~  :~ ~~ .~  ~~ ~~ .~ .~  ~~ ~~ .~  ~~ ~~  ~ .~~ MM=7$DMMM$MMMMMMMMMMMMMMMMMMM
#~ .~  ~~ ~~  ~  ~~ ~~  ~  ~~ ~~ ~~  ~. ~~ ~~ .~  ~~ ~~  ~ +IMMMMMOMMMMMMMMMMMMMMMMMMMM
#.~~ ~~  ~  ~~ ~~  ~. ~~ ~~ .~  ~  ~~ ~~  ~  ~~ ~~..~ .~~ ~~.?OMNZZMMMMMMMMMMMMMMMMMMMM
#~ .~  ~~ ~~  ~ .~~ ~~  ~  ~~ ~: ~~  ~  ~~ ~~ .~  ~~ ~~  ~  ~.,??7IZMMMMMMMMMMMMMMMMMMM
# _    _ _         _____ _                      ____  ___      _____                   
#| |  | | |       |_   _(_)                    | |  \/  |     /  __ \                  
#| |  | | |__   ___ | |  _ _ __  _ __   ___  __| | .  . |_   _| /  \/ _____      _____ 
#| |/\| | '_ \ / _ \| | | | '_ \| '_ \ / _ \/ _` | |\/| | | | | |    / _ \ \ /\ / / __|
#\  /\  | | | | (_) | | | | |_) | |_) |  __| (_| | |  | | |_| | \__/| (_) \ V  V /\__ \
# \/  \/|_| |_|\___/\_/ |_| .__/| .__/ \___|\__,_\_|  |_/\__, |\____/\___/ \_/\_/ |___/
#                         | |   | |                       __/ |                        
#                         |_|   |_|                      |___/                       

#USAGE: python parseUrlsXML.py <path to unzipped Office doc>

import os
import re
import codecs
import sys

fname = []
for root,d_names,f_names in os.walk(sys.argv[1]):
	for f in f_names:
		fname.append(os.path.join(root, f))


for fi in fname:
	with codecs.open(fi,'r', encoding="utf8", errors="ignore") as xf:
		urls = re.findall(r"(?<=\=\")http[^\"]*(?=\")", xf.read())
		for url in urls:
			if "http://schemas.microsoft.com" in url:
				pass
			elif "http://schemas.openxmlformats.org" in url:
				pass
			else:
				print(url)